---
layout: post
title: Convert OpenVPN ovpn files for use in network-manager
date: 2014-03-18 18:41:34.000000000 +00:00
type: post
published: true
status: publish
categories:
- debian
- linux
- technology
- ubuntu
tags:
- linux
- network
- openvpn
- ubuntu
meta:
  _edit_last: '20992958'
  _publicize_pending: '1'
  publicize_google_plus_url: https://plus.google.com/112653355770650909703/posts/TqyF8XnAVh1
  _wpas_done_5246225: '1'
  _publicize_done_external: a:1:{s:11:"google_plus";a:1:{s:21:"112653355770650909703";b:1;}}
  publicize_twitter_user: chrisjrob
  publicize_twitter_url: http://t.co/bNVPWbj93W
  _wpas_done_687483: '1'
  _wpas_skip_5246225: '1'
  _wpas_skip_687483: '1'
  _oembed_f50243e58f7757ad8acabba68f4ad8d7: "{{unknown}}"
author:
  login: chrisjrob
  email: chrisjrob@gmail.com
  display_name: chrisjrob
  first_name: ''
  last_name: ''
---
<p>Anyone who has enjoyed the dubious benefits of working with IPSEC will find <a title="OpenVPN" href="http://openvpn.net/">OpenVPN</a> a delight, but what do you do with your client.ovpn file once you have it?</p>
<p>If you spend most of your time in a terminal anyway, then I would suggest just putting all your client.ovpn files into ~/.openvpn, renaming them in some appropriate way, and then using them simply by typing:</p>
<p><!--more--></p>
<pre>$ sudo openvpn client.ovpn</pre>
<p>If, on the other hand, you live in a more graphically orientated world, then you might like to integrate them into Network Manager. Sadly, the Import feature in Ubuntu does not work, at least in the versions of Ubuntu that I have used, and you have to make a few changes first.</p>
<p>Firstly, I would always create a hidden directory into which to store your client files:</p>
<pre><span style="font-family:Georgia, 'Times New Roman', 'Bitstream Charter', Times, serif;font-size:14px;line-height:1.5em;">$ mkdir ~/.openvpn</span>
<span style="font-family:Georgia, 'Times New Roman', 'Bitstream Charter', Times, serif;font-size:14px;line-height:1.5em;">$ </span>cd ~/.openvpn
<span style="font-family:Georgia, 'Times New Roman', 'Bitstream Charter', Times, serif;font-size:14px;line-height:1.5em;">$ mv ~/Downloads/client.ovpn ./
</span></pre>
<p>Secondly, you need to ensure that you have installed openvpn for network-manager:</p>
<pre>$ sudo apt-get install network-manager-openvpn-gnome</pre>
<p><span style="line-height:1.5em;">Thirdly, we need to extract some data out of the client.ovpn, and for this I followed <a title="OpenVPN Access Server Client on Ubuntu" href="http://howto.praqma.net/ubuntu/vpn/openvpn-access-server-client-on-ubuntu">these instructions</a>, which I include below in case of link breakage:</span></p>
<ol>
<li><span style="font-family:Georgia, 'Times New Roman', 'Bitstream Charter', Times, serif;font-size:14px;line-height:1.5em;">Open client.ovpn in your favour text editor and copy the </span><span style="line-height:1.5em;">lines between the &lt;ca&gt; tags into a new file named client.ca.</span></li>
<li><span style="line-height:1.5em;">Remove &lt;ca&gt; section including tags.</span></li>
<li><span style="line-height:1.5em;">Now copy the lines between the &lt;cert&gt; tags into a new file named </span><span style="line-height:1.5em;">client.crt.</span></li>
<li><span style="line-height:1.5em;">Remove &lt;cert&gt; section including tags.</span></li>
<li><span style="line-height:1.5em;">Now copy the lines between &lt;key&gt; tags into a new file named </span><span style="line-height:1.5em;">client.key.</span></li>
<li><span style="line-height:1.5em;">Remove </span><span style="line-height:1.5em;">&lt;key&gt; section including tags.</span></li>
<li><span style="line-height:1.5em;">Now copy the lines between &lt;tls-auth&gt; tags into a new file named c</span><span style="line-height:1.5em;">lient.tls.</span></li>
<li><span style="line-height:1.5em;">Remove &lt;tls-auth&gt; section including tags.</span></li>
<li>Remove the line "key-direction 1".</li>
<li>Insert the following text above the line # -----BEGIN RSA SIGNATURE----- :</li>
</ol>
<pre><span style="line-height:1.5em;">ca client.ca
cert client.crt
key client.key
tls-auth client.tls 1</span></pre>
<p>Finally, save and close all the files and check that you now have all the above files sitting happily in your ~/.openvpn directory.</p>
<p>Go to Network Manager -&gt; Edit Connections -&gt;VPN and click Import, browse to the modified client.ovpn import that file.</p>
<p>Enter vpn username and password if prompted.</p>
<p>On the VPN page, select Advanced and on the General Tab, uncheck the first option, "Use custom gateway.</p>
