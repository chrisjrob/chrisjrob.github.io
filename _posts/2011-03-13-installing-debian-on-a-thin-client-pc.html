---
layout: post
title: Installing Debian on a thin client PC
date: 2011-03-13 22:53:02.000000000 +00:00
type: post
published: true
status: publish
categories:
- debian
- linux
- technology
tags:
- debian
- pekwm
meta:
  _edit_last: '20992958'
  _wpas_done_twitter: '1'
  reddit: a:2:{s:5:"count";s:1:"0";s:4:"time";s:10:"1300349466";}
  tagazine-media: a:7:{s:7:"primary";s:0:"";s:6:"images";a:0:{}s:6:"videos";a:0:{}s:11:"image_count";s:1:"0";s:6:"author";s:8:"20992958";s:7:"blog_id";s:8:"20408733";s:9:"mod_stamp";s:19:"2011-03-25
    17:33:01";}
  _oembed_5952a0f538c4938f3ec29d8780db8a4b: "{{unknown}}"
  _oembed_5b104bfef7a44c993828372c4c1fb479: "{{unknown}}"
  _oembed_24d4514bb8e8948ddc7bf10455c71439: "{{unknown}}"
  _oembed_45bc1ada32920de37ccd30cc8b451c4b: "{{unknown}}"
author:
  login: chrisjrob
  email: chrisjrob@gmail.com
  display_name: chrisjrob
  first_name: ''
  last_name: ''
---
<p>This Saturday I attended the <a href="http://surrey.lug.org.uk/bab20110312">Surrey Linux User Group meeting</a> held at <a href="http://siriusit.co.uk/">Sirius in Addlestone</a>.  Mike Judd of <a href="http://www.akunagroup.com/">Akuna Group</a> brought along a number of thin client PCs, along with monitors, keyboards, mice and a switch and set a challenge for attendees to attempt to install Linux on them.</p>
<p>The thin clients were IGEL thin clients with 1GB RAM and 1GB transcend flash card.  The RAM is plenty for Linux, so the main challenge was keeping the installation under 1GB, when modern Linux distros are probably 6gb or so.</p>
<p>I decided to try installing a minimal version of Debian, running just the PekWM Window Manager and not much else.  This would me the advantage of the enormous Debian repositories, with all the flexibility that this provides.<br />
<!--more--><br />
Please note that this is not a howto, in fact I have typed it up a day later from memory, there are bound to be missing steps in the process, but hopefully enough to give you the jist of what I did.</p>
<h2>The Installation</h2>
<p>As usual with thin clients there was no optical drive, I tried using <a href="http://linitx.com/viewproduct.php?prodid=12992">my fabulous IODD external hard drive</a> to serve up a Debian net install image, but it did not seem to work, not sure why as the BIOS had a USB-CDROM option.  So I had to mount the IODD on my laptop and transfer the image over to a memory key.  Fortunately Debian has a trick up its sleeve - you can now dd ISOs straight onto a memory stick - how fantastic is that?!  The command was something like this (note that you write to the drive not to a partition - e.g. /dev/sdb not /dev/sdb1):</p>
<p><code>$ sudo dd if=/mnt/_iso/debian-squeeze-netinst.iso of=/dev/sdX bs=1M</code></p>
<p>Having set the BIOS to boot first from USB-HDD and next from USB-ZIP (I can never remember which), I rebooted.  Success, I was presented with the Debian installer, taking the standard installer (non-graphical), I set the language and keyboard settings and I choose to manually partition the drive.  This was because the guided partitioning reserved 90mb for swap space, rightly or wrongly I thought this was pretty pointless, and reduced this to nil.  It has to be said that I did have some memory problems later, and some swap would be advisable.</p>
<p>Towards the end of the Debian installation, it prompted me to select what type of system I wanted to install, I unchecked all the options, in order to leave me with a bare Debian system.</p>
<p>The installation finished, I rebooted and removed the USB key.</p>
<h2>The Graphical Environment</h2>
<p>Once booted I was faced with a text login prompt.  Amazing, a full Debian system at my finger tips.  But no-one was going to be very impressed with that - I needed a graphical environment.  A quick "df" showed me that I had used 500mb of disk space, so I was already very tight for space.</p>
<p>I installed xserver-xorg and pekwm:</p>
<p><code>$ sudo apt-get install xserver-xorg pekwm</code></p>
<p>But when I tried to run "startx" to enter the graphical environment the command was not found.  For this sort of problem you need "apt-file". apt-file is a wonderful program that enables you to find which package you need for a known command (or other file).</p>
<p><code><br />
$ sudo apt-get install apt-file<br />
$ sudo apt-file update<br />
$ apt-file search bin/startx<br />
xfce4-utils: /usr/bin/startxfce4<br />
xinit: /usr/bin/startx<br />
</code></p>
<p>In this instance I wish to know which package includes the file "bin/startx".  I could just search for "startx", but I will get some pointless hits, most programs are located in a directory called "bin", so searching for "bin/startx" will only match bin commands.  The output tells me that the package that I am missing is <code>xinit</code>, so a quick apt-get:</p>
<p><code><br />
$ sudo apt-get install xinit<br />
</code></p>
<p>Now I can run pekwm with <code>startx</code>.</p>
<h2>Configuring pekwm</h2>
<p>Once into pekwm I was faced with a black screen with a cursor - don't panic - that is pekwm in its default state.  Right-mouse-click and you will have the pekwm menu.  Hmm, Terminal does not work and there are no applications listed in the menu.  Returning to the terminal with Ctrl+Alt+F1, I typed Ctrl+c to terminate pekwm and installed xterm (<code>$ sudo apt-get install xterm</code>).  Running <code>startx</code> again and this time selecting Terminal from the pekwm menu worked and I could continue my work from with pekwm.</p>
<h3>Debian Menus</h3>
<p>To get applications in the menu, we could edit the <code>~/.pekwm/menu</code> file and add the relevant menus. A better solution is to get the standard Debian menus working.  Firstly you should check that they are not already working for you, if you have an "Applications" item withing you pekwm menu, and if it is populated with the Debian applications list, then it is already working.  If not, edit the <code>~/.pekwm/menu</code> file and look for a line that looks like this:</p>
<p><code>INCLUDE = "debian-menu"</code></p>
<p>And edit it to read:</p>
<p><code>INCLUDE = "/etc/pekwm/debian-menu"</code></p>
<p>Now select PekWM from the menu and Reload and you should now have a properly populated Applications menu.</p>
<h3>WWW Browser</h3>
<p>Whilst there, add a Web Browser item, for example - see below:</p>
<p><code><br />
  RootMenu = "Pekwm" {<br />
        Entry = "Terminal" { Actions = "Exec $TERM &amp;" }<br />
        Entry = "Web Browser" { Actions = "Exec x-www-browser &amp;" }<br />
</code></p>
<p>This just tells it to run whatever the default X web browser is, which we can set later.</p>
<p>Now in a terminal window you should install your preferred browser.  I ended up installing iceweasel, but there may be a better more lightweight browser that requires fewer dependencies.  Feel free to comment with suggestions.</p>
<p>Once installed, the menu option <code>Web Browser</code> that we created earlier should be working.  If not, then just type:</p>
<p><code><br />
$ sudo update-alternatives --config x-www-browser<br />
</code></p>
<p>And select iceweasel (or your preferred browser).</p>
<h3>Set desktop background</h3>
<p>Now to make the desktop look a little prettier.  For my experiment I downloaded <a href="http://kde-look.org/usermanager/search.php?username=chrisjrob&amp;action=contents">a desktop wallpaper that I created a while ago</a>.  I installed <code>feh</code> (<code>$ sudo apt-get install feh</code>), and added the following to the <code>~/.pekwm/start</code> file:</p>
<p><code><br />
feh --bg-center your-wallpaper.jpg &amp;<br />
</code></p>
<h3>Install tint2 panel</h3>
<p>Most people expect a panel, although strictly speaking they are not required.  For this experiment though I think we should have one:</p>
<p><code><br />
$ sudo apt-get install tint2<br />
</code></p>
<p>And then add the following to the <code>~/.pekwm/start</code> file:</p>
<p><code><br />
tint2 &amp;<br />
</code></p>
<h2>Conclusions</h2>
<p>Well, I think that was about it.  People seemed to be impressed that I had a complete Debian with a GUI environment.  Though it has to be said that I was down to about 250mb of free space by the end, not even enough to install OpenOffice.</p>
<p>I forgot all about sound, and had to install alsa (<code>$ sudo apt-get install alsa</code>).  As an experiment I installed Flash, and tried watching You Tube.  Not good - without sound You Tube worked fine, but with sound the picture disappeared.  I had no time to fix this before the end of the session.</p>
<p>I really enjoyed this challenge, but what about the alternatives?  Mike installed <a href="http://www.slitaz.org/en/">Slitaz</a>, which looked gorgeous, and used well under 200mb in total.  I have been impressed with Slitaz before, and might be a good option for a project like this.</p>
<p>Thanks to Mike for organising the challenge.</p>
