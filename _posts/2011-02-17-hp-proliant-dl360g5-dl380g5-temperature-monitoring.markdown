---
layout: post
title:  "HP Proliant DL360G5 / DL380G5 Temperature Monitoring"
date:   2011-02-17 00:00:00
categories: technology linux
tags: monitoring hp proliant ipmi sensors
---

I don't have the HP Management suite installed on my HP Proliant servers, largely because they proved to be a huge resource hog, but I would like to be able to monitor stuff.  On PCs I am used to being able to use lm-sensors, so thought I'd give that a go.  Installing it prompted me to install ipmitool, which in turn needs openipmi.

    # apt-get install lm-sensors openipmi ipmitool

Then I ran the standard sensors-detect command, accepting YES for all options (I was feeling quite brave):

    # sensors-detect

This ended up writing the following into `/etc/modules`:

    # Generated by sensors-detect on Thu Feb 17 18:04:48 2011
    # You must also install and load the IPMI modules
    ipmi-si
    # Chip drivers
    # Warning: the required module ipmisensors is not currently installed
    # on your system. For status of 2.6 kernel ports check
    # http://www.lm-sensors.org/wiki/Devices. If driver is built
    # into the kernel, or unavailable, comment out the following line.
    ipmisensors

    # no driver for SMSC SCH4307 Super IO Fan Sensors yet
    coretemp

To test this without rebooting I typed the commands in succession, but found that ipmisensors did not exist, some googling suggested the module to be `ipmi_devintf`, and that indeed seemed to work:

    # modprobe ipmi-si
    # modprobe ipmi_devintf
    # modprobe coretemp

So the additions to my `/etc/modules` now looked like this:

    # Generated by sensors-detect on Thu Feb 17 18:04:48 2011
    # You must also install and load the IPMI modules
    ipmi-si
    # Chip drivers
    # Warning: the required module ipmisensors is not currently installed
    # on your system. For status of 2.6 kernel ports check
    # http://www.lm-sensors.org/wiki/Devices. If driver is built
    # into the kernel, or unavailable, comment out the following line.
    # ipmisensors
    ipmi_devintf

    # no driver for SMSC SCH4307 Super IO Fan Sensors yet
    coretemp

And then I tested the commands with:

    # sensors
    # ipmitool sensors

Both of which commands brought back sensible information.  Now I just need to work out how to incorporate this into nagios with nrpe, but that can wait for another day.

