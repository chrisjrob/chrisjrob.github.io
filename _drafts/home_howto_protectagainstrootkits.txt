---+ Protect against rootkits

<<<---
%TOC%
<<<---

---++ Warning

<!> This is how I checked and protected against rootkits and is not how I would recommend that anyone else should do so.

---++ Introduction

Apparently `rootkits` are a major problem in the linux world.  Unlike viruses, you are much more likely to be infected without realising that you even have a problem.  The purpose of this document is twofold:

   # Check for existing infection
   # Protect against future infection

Before proceeding, please read the Wikipedia page on `rootkits`;

---++ Step 1: rkhunter

I suggest you visit the rkhunter website at:

   * http://rkhunter.sourceforge.net/

%RAW%
<pre>
$ sudo apt-get install rkhunter
$ sudo rkhunter --upgrade
$ sudo rkhunter --checkall --createlogfile
</pre>
%RAW%

Read the output and take corrective action as required.

---++ Step 2: chkrootkit

I suggest you visit the chkrootkit website at:

   * http://www.chkrootkit.org

In particular, {the FAQS|http://www.chkrootkit.org/faq/#9} would suggest that you shouldn't trust the chkrootkit to use the commands on your system, bearing in mind that you suspect that they might be compromised; I chose not to take this additional precaution - you should make your decision based on the exposure of your server to the Internet and your assessment of the likelihood of your having a rootkit.

%RAW%
<pre>
$ sudo apt-get install chkrootkit
$ sudo chkrootkit
</pre>
%RAW%

---++ Step 4: tripwire

Tripwire creates a database of your system files and then tracks any changes to them.

   * http://sourceforge.net/projects/tripwire/

%RAW%
<pre>
$ sudo apt-get install tripwire
</pre>
%RAW%

Follow all the prompts, which will require you to create a Site Key Pass-phrase and a Local key Pass-phrase.  Next we need to create the database:

%RAW%
<pre>
$ sudo tripwire --init
Wrote database file: /var/lib/tripwire/hostname.domain.com.twd
The database was successfully generated.
</pre>
%RAW%

Next we run a first check:

%RAW%
<pre>
$ sudo tripwire --check
</pre>
%RAW%

This will doubtless come back with far more information than you really want.  For example I received loads of lines about "/proc/PIDNO/".


---++ References

   * {Implementing Tripwire|http://sourceforge.net/docman/display_doc.php?docid=2078&group_id=3130}
   * {Howto Linux - Tripwire|http://www.alwanza.com/howto/linux/tripwire.html}

---++ A better way

   * {Combining AIDE and Tripwire|http://linuxgazette.net/issue98/moen.html}

