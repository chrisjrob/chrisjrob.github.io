---+ Blog 2009

{image_right|portrait_christopher_roberts.jpg}

<<<---
%TOC%
<<<---


---++ 16/10/2009: Installing Nagios on Debian Lenny

Turns out this is as simple as:

%RAW%
<pre>
$ sudo -i
# apt-get install nagios3
# cd /etc/nagios3
# htpasswd -c htpasswd.users nagiosadmin
</pre>
%RAW%

Then point your browser at http://localhost/nagios3/

---++ 15/10/2009: Optimise Firefox

Apparently firefox uses sqlite for its databases, maintaining several *.sqlite files in your .mozilla/ profile directory.  Over time these become cluttered and it helps if you vacuum it:

%RAW%
<pre>
$ sudo apt-get install sqlite3
$ cd ~
$ find .mozilla/ -iname '*'.sqlite -exec sqlite3 "{}" VACUUM \;
</pre>
%RAW%

---++ 09/10/2009: DD over SSH

Wow, can't believe my last post was 4 months ago, well a quick tip to get me back into the blogging frame of mind.  If you wish to take a drive image copy over the network, then apparently you do not have to have an nfs share available.  Instead you can use ssh as follows:

%RAW%
<pre>
$ dd if=/dev/sda bs=1M | ssh root@blah "cat > /root/disk.img"
</pre>
%RAW%

Haven't tried it yet, but it sounds incredible.  The bs=1M is essential or the copy will take forever.

---++ 09/06/2009: May the source be with you

From time to time I see the comment advocating a closed source program, with the response "as I'm not a developer it doesn't bother me whether or not I have the source code".   I believe that that view is wrong, and that there are many occasions where non-developers will find benefit from having access to the source code.

For example,I've just found that Kmail will not autocomplete email addresses from an LDAP KDE resource.  A simple bug[1]; although strictly speaking it's not a bug, as it was a deliberate feature.  Fortunately there is a fix,  with a modification made to one of the components [2].  Unfortunately this fix has not found its way into Debian Lenny or Squeeze, and Sid is now KDE4. 

I could install from the KDE SVN repository, but that version has not been tested with Debian, and I don't really want to have such a significant part of a production server to have come from outside of Debian.  Perhaps I am being overly cautious.

Anyway, I changed to /usr/src and ran "apt-get source kdepim" to download the source from Debian.  I used "find" to locate the offending component, and used diff to determine what differences there were between the modified KDE version and the standard Debian version.  I was pleased to note that only one line had changed.  I copied in the new component and ran "apt-get build-dep kdepim" (with help from Dominic in #surrey).   Then a quick "./configure", a very slow "make", and a quick "sudo checkinstall make install" and the fix was made.

There are many many more benefits to open source than the ability to modify the source, but I just wanted to point out that, even for non-developers, there is a very real and very direct benefit to having the source.

May the source be with you.

[1] http://bugs.kde.org/show_bug.cgi?id=146247
[2] http://websvn.kde.org/?view=rev&revision=800071

Update - the actual patch may be found here:

   * http://goo.gl/FbHwh

---++ 27/05/2009: Building a new mailserver

Our Debian Lenny LTSP5 Install has hit a road block: currently the site are using a Citrix server at another location over a 256k connection to pick up their emails.  I really didn't feel that I could ask them all to collect their emails over a 256k connection, so what are the alternatives?  Well I could upgrade the bandwidth by creating an inter-site VPN, but that will still only provide perhaps 600k (that being the upload bandwidth of the host site).  The solution is to move the mailserver onto the 'net, so that they can benefit from a full 8mb ADSL download.

After seeking advice, I choose Bytemark as a trusted Debian VPS supplier, a day later I had my login to my new virtual server.  But what to install?  Advice pointed me in the direction of Postfix and Dovecot, which were not much more than an apt-get install:

   * http://www.debianadmin.com/debian-mail-server-setup-with-postfix-dovecot-sasl-squirrel-mail.html

Great, a working mailserver, but the problem with the installation was that the users were local system accounts, which made it more cumbersome to administer.  The best solution seemed to be LDAP, and I duly followed the guide {Debuntu|http://www.debuntu.org/ldap-server-and-linux-ldap-clients} to install, and I managed to integrate LDAP with PAM thus giving me the ability to allow users to login with an LDAP account; but in a nutshell that was exactly what was wrong with this solution - the users *had* to login to the server, before their system account would be created, and if that was the case I might as well have stuck with local system accounts in the first place.  What I needed was a true virtual mail host.  To that end, I was pointed in the direction of a Ubuntu howto on Howtoforge:

   * http://www.howtoforge.com/postfix-virtual-hosting-with-ldap-and-dovecot-on-ubuntu8.04

Okay but this was for Ubuntu not Debian and for one reason and another I simply could not get it working.  After starting from scratch a couple of times, but ending up in the same place, I found that I had to combine the howto with this one for 8.10:

   * http://www.howtoforge.com/postfix-virtual-hosting-with-ldap-backend-and-with-dovecot-pop3-imap-on-ubuntu-8.10

Even then it took a fair amount of battling to get it working on Debian Lenny.  The key to most of my problems was in reading the comments on every page, as these include invaluable corrections and suggestions.

So after a week of pain, I now have a working virtual mail host, now I just need to set-up the domains, users and mailgroups.

